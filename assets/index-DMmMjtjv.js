var nt=Object.defineProperty;var Q=a=>{throw TypeError(a)};var at=(a,t,e)=>t in a?nt(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var B=(a,t,e)=>at(a,typeof t!="symbol"?t+"":t,e),X=(a,t,e)=>t.has(a)||Q("Cannot "+e);var N=(a,t,e)=>(X(a,t,"read from private field"),e?e.call(a):t.get(a)),$=(a,t,e)=>t.has(a)?Q("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,e),V=(a,t,e,s)=>(X(a,t,"write to private field"),s?s.call(a,e):t.set(a,e),e),A=(a,t,e)=>(X(a,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();const T={name:`
      __         ____            __               __      
     / / ___ _  / __/__ ____ _  / / ___ ____ ____/ / ___ _
    / /_/ _ \`/ / /__/ // /  ' \\/ _ / _ \`/ _ / __/ _ / _ \`/
   /____\\_,_/  \\___/\\_,_/_/_/_/_.__\\_,_/_//_\\__/_//_\\_,_/ 

`,sea:"\n  )`.\\  )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.\n-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'\n",submarine:"\n                           |`-:_\n  ,----....____            |    `+.\n (             ````----....|___   |\n  \\     _                      ````----....____\n   \\    _)                                     ```---.._\n    \\                                                   \\\n  )`.\\  )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.   )`.\n-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'   `-'\n",ship1:`
                                     |__
                                     |\\/
                                     ---
                                     / | [
                              !      | |||
                            _/|     _/|-++'
                        +  +--|    |--|--|_ |-
                     { /|__|  |/\\__|  |--- |||__/
                    +---------------___[}-_===_.'____         
                __\`-' ||___-{]_| _[}-  |     |_[___\\==--            _
__...__--==/___]_|__|_____________________________[___\\==--_,------' .7
\\                                                              MM-666/
 \\___________________________________________________________________|
`,ship2:`
                                     # #  ( )
                                  ___#_#___|__
                              _  |____________|  _
                       _=====| | |            | | |==== _
                 =====| |.---------------------------. | |====
<-------------------'   .  .  .  .  .  .  .  .   '--------------/
 \\                                                             /
  \\_______________________________________________A42_________/
`,loser:`
                                     .
          ,d88b,                                     .                   __..-
          888888                                        .            .--MM666.
          \`?88P'         .                       __                ,'WWII::.
                                               .MW:\`-.            /WWII::..
                                       .    _.MWII:'. \`.     .  ,'WII::..
                                        _.-MWII::'.     \`-.   ,'WWI::.
    .                          _..vvvv,'WWII::'            \`.'WII::.
                            ,-'WI:'''/WII:'.                 \\WI:.
--------------------.==.--,'WWI:'.  /WI:'.          :.        \`.I:.
            -.      (88),'WWI:'.  ,'I:.              ::.        \\..
     -    ~-~_~ _./d88P/\\?I:'.   /WI:.                ::.        \\ .
          ~-~-,-~' ~~~ / )------'WI:.____ _.d88P_____::::.        \\
   _       ,-'  .     /</        __..--~~  ,P^'      ~~~~~~~~~~~~~~"""""""""""
\`?-._    ,' -   -   ,' !\\__..--~~  |  |   ,P'            -          _
  \\\`=~.~/     _    /--~~~\\  \\   \\  \\  \\ ,dP'   -   _           -         _
   \\ \\ \\ ~--.___.-'\\, \\  |\`. \`.  \`. \`.,dP' _            -
 - _\`.____....____  \`_____...---.._:dP'_ -  .  -              _
-_. -_ -  . _ - _ ~~~ . _  - _ -  _  _ -  -  .      -             -   .   -
   _   -  .   _   -  -    _     _       .      _             _         _
       -            -              _
`,winner:"\n                                           ///\\\n                                          |//-(\n                                        _.J.__/\n                                       /       `.\n                                    .-/          |\n                                  .-(-\\_/      `|'\n                               .-'_     |       |`-._\n                            .)''/ /`----F       |__ ``-.(_\n                         .-''|(--------/_____.-'.---`-._|_`--._\n                      .-''  J`----------------+'     \"Y\"\"\"\"F``-.`-.\n                   .-''      L .  .. . --'    Y      /.`-  F:.   `-`-._ . .  ..   ..  ...:::.....\n ..  . ..  .   .-'-'          \\         .. - ' \\    /\\ `. >           ``-.__    . ..\n'..   .   . .-'-'              \\  _ - \"     . ' `--'\\ .  v   :.           ``-``--._  .:::..'''':.\n  ...:::..-'.'                 _`-.      '     / | L \\ \\/                     `-.  `-::.::::':::..\n''''''   '' -                 - --`-. '    /  /  .    .'-                     _- ''''    '::::''\n                             - -- - -`--._ ___ /_|_.-'- --\n                             -  ---  ----  --  ---  --- - -\n                                 ------ --- ----- -- ----\n                               --  --- --------  -- ----\n                                          -- --   -\n\n"},P=class P{constructor(t){this.type=t,this.length=P.shipsAndSize[t],this.hits=0,this.sunk=!1}hit(){this.hits++,this.isSunk()}isSunk(){this.sunk=this.length===this.hits}};B(P,"shipsAndSize",{Carrier:5,Battleship:4,Cruiser:3,Submarine:3,Destroyer:2});let L=P;class g{constructor(){B(this,"shipsInventory",{available:Object.keys(L.shipsAndSize),placed:new Set,sank:new Set});this.ships=g.boardGenerator()}static boardGenerator(){return Array.from({length:10},()=>Array(10).fill(!1))}static fixSpace(t,e){return Math.max(0,Math.min(t,10-e))}getShips(){const t=this.shipsInventory.available.length,e=this.shipsInventory.available.shift(),s=L.shipsAndSize[e];return{shipsLeft:t,ship:e,size:s}}placeShip(t,e,s,n){const r=new L(n),o=s?g.fixSpace(t,r.length):t,i=s?e:g.fixSpace(e,r.length);for(let c=0;c<r.length;c++){const u=s?i:i+c,d=s?o+c:o;if(this.ships[u][d])return!1}for(let c=0;c<r.length;c++){const u=s?i:i+c,d=s?o+c:o;this.ships[u][d]=r}return this.shipsInventory.placed.add(n),!0}placeShipRandom(t){const e=Math.floor(Math.random()*10),s=Math.floor(Math.random()*10),n=!!Math.floor(Math.random()*2);return this.placeShip(e,s,n,t)||this.placeShipRandom(t),!0}placeRemainignShipsRandom(){for(const t of Object.keys(L.shipsAndSize))this.shipsInventory.placed.has(t)||this.placeShipRandom(t)}resetShips(){this.ships=g.boardGenerator(),this.shipsInventory.available=Object.keys(L.shipsAndSize),this.shipsInventory.placed=new Set}receiveAttack(t,e){const s=this.ships[e][t];return s&&typeof s!="object"?null:typeof s=="object"?(this.ships[e][t]="X",s.hit(),s.sunk?(this.shipsInventory.sank.add(s.type),this.shipsInventory.sank.size===5?"No ships left":"Sunk"):"Ship"):(this.ships[e][t]="~","Water")}}const q=document.querySelector("#app"),x=()=>{q.textContent=""},l=(a,t="",e="",s=void 0)=>{const n=document.createElement(a);return n.className=e,n.textContent=t,s&&n.setAttribute("data-cell",s),n},M=(a,t)=>{const e=l("label",a),s=document.createElement("input");return s.type="text",s.placeholder=t,e.append(s),e},rt=(a,t,e,s,n)=>{const r=l("label",a),o=document.createElement("input");return o.type="number",o.max=e,o.min=s,o.defaultValue=n,o.placeholder=t,r.append(o),r},y=(a,t="",e="")=>{const s=document.createElement("button");return s.type="button",s.className=t,s.textContent=a,e&&s.setAttribute("data-cell",e),s},Z=()=>{const a=l("div","","board");for(let t=0;t<11;t++){const e=t===0?"\\":String.fromCharCode(64+t),s=l("span",e,"board__coordenates");a.append(s)}return a},j=a=>{const t=Z();t.setAttribute("data-board","myShips");let e=1;return a.board.ships.flat().forEach((s,n)=>{const r=n%10,o=Math.floor(n/10);let i=s||"";const c=/\s|X/i.test(s)?"board__ships board__ships--occupied":"board__ships";r===0&&(t.append(l("span",e,"board__coordenates")),e++),typeof s=="object"&&(i=s.type.slice(0,2)),t.append(l("span",i,c,`${o}-${r}`))}),t},ot=()=>{const a=l("form"),t=M("Ingresa las coordenadas y presiona [Enter] para confirmar o, escribe <No sé> para ubicar aleatoriamente","<A-J> <1-10> <(H)orizontal/(V)ertical>");return a.append(t),a},it=(a,t)=>{const e=a.slice(0,2),s=l("div","","dialog__dock"),n=l("div","","dock__ship");n.draggable=!0;for(let u=0;u<t;u++){const d=l("div",e,"ship__section",u);n.append(d)}const r=l("div","","dialog__options"),o=y("Girar"),i=y("Ubicación aleatoria");r.append(o,i),o.addEventListener("pointerdown",()=>{n.classList.toggle("dock__ship--vertical")}),s.append(n);const c=l("div","","dialog__drag");return c.append(s,r),c},J=(a,t,e,s,n)=>{const r=e?g.fixSpace(a,n):a,o=e?t:g.fixSpace(t,n);for(let i=0;i<n;i++){const c=e?r+i:r,u=e?o:o+i,d=document.querySelector(`[data-cell="${u}-${c}"]`);d.textContent?d.classList.add("board__ships--warn"):(d.setAttribute("data-current",!0),d.classList.add("board__ships--occupied"),d.textContent=`${s.slice(0,2)}`)}},O=()=>{document.querySelector("[data-current]")&&document.querySelectorAll("[data-current]").forEach(a=>{a.removeAttribute("data-current"),a.className="board__ships",a.textContent=""}),document.querySelectorAll(".board__ships--warn")&&document.querySelectorAll(".board__ships--warn").forEach(a=>{a.classList.remove("board__ships--warn")})},ct=(a,t,e=void 0)=>{x();const s=e?`${a.name}, ¿Quieres esta disposición para tu flota?`:`${a.name}, ubica tus barcos...`,n=l("header"),r=l("h1",s);n.append(r);const o=j(a),i=l("div","","settings");if(e){const c=y("No, volver a ubicar","set","reset"),u=y("Sí","","confirm");i.append(c,u)}else{const c=l("nav"),u=y("Coordenadas","","byInput"),d=y("Arrastrar y soltar","","byDragDrop");c.append(u,d);const{shipsLeft:h,ship:_,size:m}=t,p=l("div","","settings__dialog"),b=l("p",`${_} (${_.slice(0,2)}), quedan ${h} barcos por ubicar.`,"dialog__ship"),f=ot(),v=it(_,m);a.preferences.drag?f.classList.add("hidden"):v.classList.add("hidden"),p.append(b,f,v);const w=y("Reiniciar","","reset");i.append(c,p,w)}q.append(n,o,i)},dt=a=>{const t=Z();t.setAttribute("data-board","myAttacks");let e=1;return a.myAttacks.flat().forEach((s,n)=>{const r=n%10,o=Math.floor(n/10);if(r===0&&(t.append(l("span",e,"board__coordenates")),e++),s){let i="board__ships";s==="X"&&(i+=" board__ships--occupied"),t.append(l("span",s,i,`${o}-${r}`));return}t.append(y("","board__attack",`${o}-${r}`))}),t},_t=(a,t)=>{const[e,s]=a.split("-"),n=t==="Water"?"~":"X";let r="board__ships";r+=t==="Water"?" board__ships--occupied":" board__ships--warn";const o=l("span",n,r,a),i=document.querySelector(`[data-cell="${e}-${s}"]`);i.parentNode.replaceChild(o,i)},U=a=>{const t=document.querySelector('[data-board="myShips"]'),e=document.querySelector('[data-board="myAttacks"]');t.classList.toggle("hidden",a!=="ships"),e.classList.toggle("hidden",a!=="attacks")},lt=(a,t)=>{const e=l("div","","radar"),s=l("div","","radar__sweep");a.preferences.radar||e.classList.add("hidden");const n=l("header"),r=l("h1",`¡${a.name}, es hora de atacar!`),o=a.preferences.radar?"Apagar el radar":"Encender el radar",i=y(o,"","radar"),c=l("div","","settings"),u=l("nav"),d=y("Ver mis disparos","","myAttacks"),h=y("Ver mis barcos","","myShips"),_=l("div","","settings__dialog"),m=l("span",`00:${String(t).padStart(2,"0")}`,"counter warn"),p=M("Escribe las coordenadas de tu ataque y presiona [Enter] para disparar:","<A-J> <1-10> / <Aleatorio/Random>"),b=y("¡Disparo automático!","set","attackRND"),f=dt(a),v=j(a);v.classList.add("hidden"),x(),e.append(s),n.append(r,i),u.append(d,h),_.append(m,p,b),c.append(_),q.append(e,n,u,f,v,c)},ut=a=>{const t=l("header"),e=l("h1",`¡${a.name}, te atacan!`),s=j(a);x(),t.append(e),q.append(t,s)},Y=(a,t,e,s)=>{x();const n=2,r=`${t.name}, entrégale el dispositivo a ${e.name}`,o=a==="shipsPlacement"?`${e.name}, haz clic aquí o presiona [Enter] para ubicar tus barcos`:`${e.name}, haz clic aquí o presiona [Enter] para realizar tu ataque`,i=T[`ship${Math.floor(Math.random()*n)}`],c=u=>{u.type!=="pointerdown"&&u.key!=="Enter"||(document.removeEventListener("keydown",c),s(e))};q.append(l("p",r),l("pre",i),y(o)),document.querySelector("button").addEventListener("pointerdown",c),document.addEventListener("keydown",c)},R=(a,t=void 0)=>{x();const e=T[a],n=t?`Así se hace ${t.name}, ¿quieres jugar una nueva partida? (S)í / (N)o`:`${a==="winner"?"¡Ganaste!,":"Perdiste,"} ¿Una nueva partida? (S)í / (N)o`,r=o=>{const i=o.key.toLowerCase();i!=="s"&&i!=="n"||(document.body.removeEventListener("keydown",r),i==="s"?location.reload():i==="n"&&(window.location.href="https://cv.mmejia.com"))};q.append(l("pre",e),l("div",n)),document.body.addEventListener("keydown",r)};var E,D,S,tt,et,W,st;class K{constructor(t=void 0){$(this,S);$(this,E);$(this,D,{Water:()=>{this.nextAttack.hits.length>1&&A(this,S,st).call(this)},Ship:(t,e)=>{A(this,S,tt).call(this,t,e)},Sunk:(t,e)=>{if(this.nextAttack.suspicious--,!this.nextAttack.suspicious)this.nextAttack.hits=[],this.nextAttack.queue=[];else{this.nextAttack.hits.push([e,t]);const[s,n]=A(this,S,W).call(this),r=[...new Set(this.nextAttack.queue.map(o=>o.join(",")))].map(o=>o.split(",").map(Number));this.nextAttack.hits=this.nextAttack.hits.filter(o=>o[s]!==n),this.nextAttack.queue=r.filter(o=>o[s]!==n)}}});this.board=new g,this.myAttacks=g.boardGenerator(),this.adversaryName=void 0,this.score=0,this.preferences={drag:!1,radar:!0},t?this.name=t:this.nextAttack={hits:[],queue:[],suspicious:0}}setAdversary(t){V(this,E,t),this.adversaryName=N(this,E).name??"AutoPlayer",t.adversaryName||t.setAdversary(this)}attack(t,e){if(t>9||e>9||this.myAttacks[e][t])return!1;const s=N(this,E).board.receiveAttack(t,e);return this.score=N(this,E).board.shipsInventory.sank.size,this.myAttacks[e][t]=s==="Water"?"~":"X",!this.name&&s!=="No ships left"&&N(this,D)[s](t,e),s}attackAuto(){var t;return!((t=this.nextAttack)!=null&&t.suspicious)||!this.nextAttack.queue?this.attackRandom():A(this,S,et).call(this)}getRandomCoordenates(){const t=this.myAttacks.flatMap((n,r)=>n.map((o,i)=>o?null:[r,i]).filter(o=>o)),[e,s]=t[Math.floor(Math.random()*t.length)];return{rCol:s,rRow:e}}attackRandom(){const{rCol:t,rRow:e}=this.getRandomCoordenates();return this.attack(t,e)}}E=new WeakMap,D=new WeakMap,S=new WeakSet,tt=function(t,e){const n=[[-1,0],[0,1],[1,0],[0,-1]].map(([d,h])=>[e+d,t+h]).filter(([d,h])=>{var _;return((_=this.myAttacks[d])==null?void 0:_[h])===!1}),r=this.nextAttack;if(r.hits.push([e,t]),r.hits.length===1){r.queue=n,r.suspicious++;return}const[o,i]=A(this,S,W).call(this);r.hits.length===2&&r.queue.sort(d=>d[o]===i?-1:0);const[c,u]=n.reduce(([d,h],_)=>(_[o]===i?d.push(_):h.push(_),[d,h]),[[],[]]);r.queue.unshift(...c),r.queue.push(...u)},et=function(){const[t,e]=this.nextAttack.queue.shift();return this.attack(e,t)},W=function(){const t=this.nextAttack.hits,e=t[0][1]===t[t.length-1][1]?1:0,s=t[0][e];return[e,s]},st=function(){const t=this.nextAttack.queue,[e,s]=A(this,S,W).call(this);t.filter(n=>n[e]===s).length||(this.nextAttack.suspicious=this.nextAttack.hits.length)};document.querySelector("#app");class ht{constructor(t,e,s){B(this,"activeCountdowns",[]);this.player1=new K(t!==""?t:void 0),this.player2=new K(e!==""?e:void 0),this.timerSec=+s,this.AttackDelaySec=0,this.underAttackDelaySec=1,this.rndBaseMs=0,this.evalAttackFeedback=0,this.player1.setAdversary(this.player2)}dragNDropHandler(t,e,s){const n=document.querySelector(".dock__ship"),r=document.querySelectorAll(".ship__section"),o=document.querySelectorAll(".board__ships");let i,c;r.forEach(d=>{d.addEventListener("pointerdown",()=>{i=+d.getAttribute("data-cell")}),d.addEventListener("pointerup",()=>{i=void 0})});const u=(d,h)=>{if(!d)return;const[_,m]=d.split("-"),p=!document.querySelector(".dock__ship--vertical"),b=p?+m-+h:+m,f=p?+_:+_-+h;return{col:b,row:f,horizontal:p}};o.forEach(d=>{d.addEventListener("dragenter",()=>{O(),c=d.getAttribute("data-cell");const{col:h,row:_,horizontal:m}=u(c,i);J(h,_,m,e,s)})}),n.addEventListener("dragend",()=>{if(O(),!u(c,i))return;const{col:d,row:h,horizontal:_}=u(c,i);t.board.placeShip(d,h,_,e)&&this.setShips(t)})}setShips(t){if(!t.name){t.board.placeRemainignShipsRandom(),this.switcher("shipsPlacement",t);return}const e=t.board.shipsInventory.placed.size===5,{shipsLeft:s,ship:n,size:r}=t.board.getShips();if(ct(t,{shipsLeft:s,ship:n,size:r},e),document.querySelector('[data-cell="reset"]').addEventListener("pointerdown",()=>{t.board.resetShips(),this.setShips(t)}),e){document.querySelector('[data-cell="confirm"]').addEventListener("pointerdown",()=>{this.switcher("shipsPlacement",t)});return}const i=document.querySelector('[data-cell="byInput"]'),c=document.querySelector('[data-cell="byDragDrop"]'),u=document.querySelector("form"),d=document.querySelector(".dialog__drag"),h=document.querySelector("input");let _=null;i.addEventListener("pointerdown",()=>{d.classList.add("hidden"),u.classList.remove("hidden"),t.preferences.drag=!1}),c.addEventListener("pointerdown",()=>{d.classList.remove("hidden"),u.classList.add("hidden"),t.preferences.drag=!0}),this.dragNDropHandler(t,n,r),h.addEventListener("input",m=>{O();const p=m.target,b=p.value.match(/\bRRRRR\b/),f=p.value.match(/random|aleatorio|no s[eé]/i),v=p.value.match(/(10|[1-9])/),w=p.value.match(/\b[a-j]\b/i),I=p.value.match(/\b(hor|ver)/i);if(_=null,b){_="RRRRR";return}if(f){_="random";return}if(!v||!w||!I)return;const z=+v[0]-1,F=+w[0].toLowerCase().charCodeAt(0)-97,C=/hor/i.test(I[0]),H=C&&F+r>10?10-r:F,G=!C&&z+r>10?10-r:z;J(H,G,C,n,r),_=document.querySelector(".board__ships--warn")?null:{row:G,col:H,horizon:C,ship:n}}),h.addEventListener("keydown",m=>{if(m.key==="Enter"&&(m.preventDefault(),!!_)){if(_==="random")t.board.placeShipRandom(n);else if(_==="RRRRR")t.board.placeRemainignShipsRandom();else if(_.ship){const{col:p,row:b,horizon:f,ship:v}=_;t.board.placeShip(p,b,f,v)}this.setShips(t)}})}async receiveAttack(t,e){ut(t),document.body.classList.add("alarm");let s;do{s=e.attackAuto(),await this.delayActions(this.underAttackDelaySec,!0);const n=j(t),r=document.querySelector(".board");if(r.parentNode.replaceChild(n,r),await this.delayActions(this.evalAttackFeedback),s==="No ships left"){this.switcher("winner",e);return}}while(s!=="Water");document.body.classList.remove("alarm"),this.switcher("attack",e)}playerAttack(t){lt(t,this.timerSec),this.createCountdown(t);const e=document.querySelector('[data-cell="radar"]'),s=document.querySelector(".radar"),n=document.querySelector('[data-cell="myAttacks"]'),r=document.querySelector('[data-cell="myShips"]');e.addEventListener("pointerdown",()=>{t.preferences.radar=!t.preferences.radar,s.classList.toggle("hidden",t.preferences.radar===!1),e.textContent=s.classList.contains("hidden")?"Encender radar":"Apagar radar"}),n.addEventListener("pointerdown",()=>{U("attacks")}),r.addEventListener("pointerdown",()=>{U("ships")});const o=document.querySelectorAll(".board__attack"),i=document.querySelector('[data-cell="attackRND"]'),c=document.querySelector("input");let u=null;const d=async(h,_)=>{this.purgeCountdowns();const m=document.querySelectorAll("button"),p=t.attack(+_,+h),b=document.querySelector(`[data-cell="${h}-${_}"]`);m.forEach(f=>{f.disabled=!0}),await this.delayActions(this.AttackDelaySec),document.body.classList.toggle("alarm",p==="Ship"),_t(b.getAttribute("data-cell"),p),await this.delayActions(this.evalAttackFeedback),p==="Water"?this.switcher("attack",t):p==="No ships left"&&this.switcher("winner",t),m.forEach(f=>{f.disabled=!1}),c.value="",this.createCountdown(t)};o.forEach(h=>{h.addEventListener("pointerdown",_=>{_.target.classList.add("board__attack--aim");const[m,p]=h.getAttribute("data-cell").split("-");d(m,p)})}),i.addEventListener("pointerdown",()=>{const{rRow:h,rCol:_}=t.getRandomCoordenates();document.querySelector(`button[data-cell="${h}-${_}"]`).classList.add("board__attack--aim"),d(h,_)}),c.addEventListener("input",()=>{var v;u=null,(v=document.querySelector(".board__attack--aim"))==null||v.classList.remove("board__attack--aim");const h=c.value.match(/aleatorio|random/i),_=c.value.match(/[a-j]/i),m=c.value.match(/(10|[1-9])/);if(h){const{rRow:w,rCol:I}=t.getRandomCoordenates();document.querySelector(`button[data-cell="${w}-${I}"]`).classList.add("board__attack--aim"),u={row:w,col:I};return}if(!m||!_)return;const p=+m[0]-1,b=+_[0].toLowerCase().charCodeAt(0)-97,f=document.querySelector(`button[data-cell="${p}-${b}"]`);f&&(f.classList.add("board__attack--aim"),u={row:p,col:b})}),c.addEventListener("keydown",h=>{if(h.key!=="Enter"||!u)return;const{row:_,col:m}=u;d(_,m)})}delayActions(t){const e=t*1e3+Math.floor(Math.random()*this.rndBaseMs);return new Promise(s=>setTimeout(s,e))}purgeCountdowns(){this.activeCountdowns.forEach(clearInterval),this.activeCountdowns.length=0}countdown(t){return new Promise(e=>{let s=this.timerSec;const n=setInterval(()=>{s-=1,t(s),s<=0&&(clearInterval(n),e(s))},1e3);this.activeCountdowns.push(n)})}createCountdown(t){this.purgeCountdowns();const e=document.querySelector(".counter.warn");e&&(e.textContent=`00:${String(this.timerSec).padStart(2,"0")}`,this.countdown(s=>{e.textContent=`00:${String(s).padStart(2,"0")}`;const n=Math.max(this.timerSec/4,3);s<n&&document.body.classList.add("alarm")}).then(()=>{document.body.classList.remove("alarm"),this.switcher("attack",t)}))}switcher(t,e){const s=this.player1.name&&this.player2.name,n=this.player1.name&&!this.player2.name,r=!this.player1.name&&this.player2.name,o=e,i=e===this.player1?this.player2:this.player1;if(t==="shipsPlacement")if(s){const c=o===this.player1?this.setShips.bind(this):this.playerAttack.bind(this);Y(t,o,i,c)}else n?o===this.player1?this.setShips(i):this.playerAttack(i):r&&(o===this.player2?this.receiveAttack(o,i):this.setShips(i));else t==="attack"?s?Y(t,o,i,this.playerAttack.bind(this)):n?o===this.player1?this.receiveAttack(o,i):this.playerAttack(i):r&&(o===this.player1?this.playerAttack(i):this.receiveAttack(o,i)):t==="winner"&&(s?R("winner",o):n?o===this.player1?R("winner"):R("loser"):r&&(o===this.player1?R("loser"):R("winner")))}}const k=document.querySelector("#app"),pt=()=>{k.append(l("pre",T.submarine),l("pre",T.name),l("pre",T.sea),l("p","Presiona [Enter] o haz clic aquí para empezar..."));const a=t=>{(t.type==="pointerdown"||t.key==="Enter")&&(x(),k.removeEventListener("pointerdown",a),document.body.removeEventListener("keydown",a),mt())};k.addEventListener("pointerdown",a),document.body.addEventListener("keydown",a)},mt=()=>{k.append(l("p","Escribe el nombre de los jugadores o deja un espacio en blanco para jugar contra la computadora..."),M("¿Quién inicia el juego?","Nombre"),M("¿Quiés es el contrincante?","Nombre"),rt("¿Turnos de cuanto tiempo? (1-60 segundos)","<1-60>",1,60,15),y("¡Iniciar el encuentro!"));const a=t=>{if(t.type!=="pointerdown"&&t.key!=="Enter")return;const[e,s,n]=document.querySelectorAll("input");k.querySelectorAll(".warn").forEach(c=>c.remove());let o=!1;if(!e.value&&!s.value&&(k.insertBefore(l("h2","¡Debe haber al menos una persona!","warn"),k.querySelector("label")),o=!0),(isNaN(n.value)||+n.value<1||n.value>60)&&(k.insertBefore(l("h2","¡El timer sólo acepta números entre 1 y 60!","warn"),k.querySelector("label")),o=!0),o)return;document.body.removeEventListener("keydown",a);const i=new ht(e.value,s.value,+n.value);i.setShips(i.player1)};document.querySelector("button").addEventListener("pointerdown",a),document.body.addEventListener("keydown",a)};pt();
